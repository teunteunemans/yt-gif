---
phase: 01-foundation
plan: 01
type: execute
depends_on: []
files_modified: [wxt.config.ts, package.json, src/entrypoints/background.ts, src/entrypoints/popup/index.html, src/entrypoints/popup/main.tsx, src/entrypoints/popup/App.tsx, tsconfig.json, .gitignore]
---

<objective>
Set up WXT extension scaffold with TypeScript and cross-browser configuration.

Purpose: Establish the project foundation that all future phases build upon.
Output: Working extension that loads in both Chrome and Firefox dev modes with basic popup UI.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-foundation/01-RESEARCH.md

**From RESEARCH.md:**
- Use `pnpm dlx wxt@latest init` with React template
- Configure `srcDir: 'src'` for cleaner structure
- Add `@wxt-dev/module-react` for React support
- Must include `gecko.id` for Firefox compatibility
- Use WXT's `browser` object, never `chrome.*` directly
- Avoid `src/modules/` directory (WXT reserved)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Initialize WXT project with React template</name>
  <files>package.json, tsconfig.json, wxt.config.ts, src/entrypoints/popup/*, .gitignore</files>
  <action>
    Run `pnpm dlx wxt@latest init` in project root:
    - Select "React" as the UI framework
    - Accept default options

    After init, restructure for srcDir:
    - Move entrypoints/ to src/entrypoints/
    - Move assets/ to src/assets/ if created
    - Update wxt.config.ts to set `srcDir: 'src'`

    Install React module:
    - Run `pnpm install -D @wxt-dev/module-react`
    - Add to wxt.config.ts modules array

    Update .gitignore to include:
    - .output/
    - .wxt/
    - node_modules/

    AVOID: Creating src/modules/ directory (WXT reserved). AVOID: Using chrome.* API directly.
  </action>
  <verify>
    - `pnpm run dev` starts without errors
    - Browser opens with extension loaded
    - Popup shows default WXT React content
  </verify>
  <done>WXT project initialized, dev server runs, popup displays in browser</done>
</task>

<task type="auto">
  <name>Task 2: Configure cross-browser manifest</name>
  <files>wxt.config.ts, src/entrypoints/background.ts</files>
  <action>
    Update wxt.config.ts with YT-GIF specific configuration:

    ```typescript
    import { defineConfig } from 'wxt';

    export default defineConfig({
      srcDir: 'src',
      modules: ['@wxt-dev/module-react'],
      manifest: ({ browser }) => ({
        name: 'YT-GIF',
        version: '0.1.0',
        description: 'Create GIFs from YouTube videos',
        permissions: ['activeTab', 'storage'],
        host_permissions: ['*://*.youtube.com/*'],
        ...(browser === 'firefox' && {
          browser_specific_settings: {
            gecko: {
              id: 'yt-gif@example.com',
              strict_min_version: '109.0'
            }
          }
        })
      })
    });
    ```

    Create minimal background script:
    ```typescript
    // src/entrypoints/background.ts
    export default defineBackground(() => {
      console.log('YT-GIF background script loaded', { id: browser.runtime.id });
    });
    ```

    Update package.json scripts:
    ```json
    {
      "scripts": {
        "dev": "wxt",
        "dev:firefox": "wxt -b firefox",
        "build": "wxt build",
        "build:firefox": "wxt build -b firefox",
        "zip": "wxt zip",
        "zip:firefox": "wxt zip -b firefox"
      }
    }
    ```

    AVOID: Hardcoding browser detection. Use `import.meta.env.BROWSER` if needed.
  </action>
  <verify>
    - `pnpm run build` produces .output/chrome-mv3/
    - `pnpm run build:firefox` produces .output/firefox-mv2/
    - Firefox build contains gecko.id in manifest.json
    - Chrome build does NOT contain browser_specific_settings
  </verify>
  <done>Both Chrome MV3 and Firefox MV2 builds succeed with correct manifests</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `pnpm run dev` starts Chrome with extension
- [ ] `pnpm run dev:firefox` starts Firefox with extension
- [ ] `pnpm run build` succeeds for Chrome
- [ ] `pnpm run build:firefox` succeeds for Firefox
- [ ] Popup displays in both browsers
- [ ] Background script logs message (check devtools console)
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- Extension loads in both Chrome and Firefox
- Cross-browser builds produce correct manifests
- Phase 1 complete
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-01-SUMMARY.md`
</output>
