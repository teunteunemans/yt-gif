---
phase: 03-gif-creation
plan: 01
type: execute
depends_on: []
files_modified: [src/entrypoints/youtube.content/App.tsx, src/entrypoints/youtube.content/GifCreator.tsx, src/entrypoints/youtube.content/style.css]
---

<objective>
Create time range selection UI for GIF creation.

Purpose: Enable users to select start/end times and configure GIF settings before capture.
Output: Modal panel with video preview, time range controls, and "Create GIF" trigger button.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/02-youtube-integration/02-01-SUMMARY.md
@src/entrypoints/youtube.content/App.tsx
@src/entrypoints/youtube.content/index.tsx
@src/entrypoints/youtube.content/style.css

**Tech available:** React 19, WXT, TypeScript, Shadow DOM isolation
**Established patterns:** Shadow DOM UI via createShadowRootUi, YouTube toolbar integration
**Prior decisions:** Shadow DOM for CSS isolation, MutationObserver for async YouTube elements

**Discovery findings:**
- GIF creation will use gifenc library (Plan 03-02)
- Canvas drawImage approach works for YouTube videos in content script context
- Most YouTube videos are not DRM-protected, so frame capture is feasible
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GIF creator modal component</name>
  <files>src/entrypoints/youtube.content/GifCreator.tsx</files>
  <action>
Create GifCreator React component that renders a modal overlay. Structure:
- Fixed position overlay covering the video player area
- Panel with: close button, video preview thumbnail, time controls, settings
- Time controls: start time input (MM:SS), end time input (MM:SS), current video position indicator
- Settings: FPS selector (5, 10, 15 FPS options), width selector (320, 480, 640px)
- "Create GIF" button that calls onCreateGif prop with {startTime, endTime, fps, width}
- "Cancel" button to close modal

Props interface:
```typescript
interface GifCreatorProps {
  videoElement: HTMLVideoElement;
  onCreateGif: (settings: GifSettings) => void;
  onClose: () => void;
}

interface GifSettings {
  startTime: number;  // seconds
  endTime: number;    // seconds
  fps: number;
  width: number;
}
```

Default startTime to current video position, endTime to startTime + 3 seconds (capped at video duration).
Use video.currentTime, video.duration for initial values.

Style within Shadow DOM - no external CSS dependencies.
  </action>
  <verify>Component renders without TypeScript errors: `npm run build` succeeds</verify>
  <done>GifCreator.tsx exists with modal, time inputs, FPS/width selectors, and create/cancel buttons</done>
</task>

<task type="auto">
  <name>Task 2: Wire GIF button to open modal</name>
  <files>src/entrypoints/youtube.content/App.tsx</files>
  <action>
Update App.tsx to:
1. Add state: `const [showCreator, setShowCreator] = useState(false)`
2. Find YouTube video element when button clicked: `document.querySelector('video.html5-main-video')`
3. On GIF button click: find video element, setShowCreator(true)
4. Render GifCreator when showCreator is true, passing video element
5. Handle onClose to setShowCreator(false)
6. Stub onCreateGif to console.log settings (Plan 03-02 will implement actual encoding)

Handle edge case: if video element not found, show console warning and don't open modal.
  </action>
  <verify>Click GIF button on YouTube video → modal opens with video duration shown → click Cancel → modal closes</verify>
  <done>GIF button click opens GifCreator modal, Cancel closes it, Create logs settings to console</done>
</task>

<task type="auto">
  <name>Task 3: Style modal to match YouTube aesthetic</name>
  <files>src/entrypoints/youtube.content/style.css, src/entrypoints/youtube.content/GifCreator.tsx</files>
  <action>
Add CSS for GifCreator in style.css (within Shadow DOM scope):
- Dark semi-transparent overlay background (rgba(0,0,0,0.8))
- Centered modal panel with dark background (#212121), rounded corners (8px)
- White/light text (#fff, #aaa for secondary)
- Input styling: dark backgrounds (#303030), light borders, white text
- Button styling: Primary red (#ff0000) for Create GIF, secondary gray for Cancel
- Consistent with YouTube's dark theme aesthetic
- Responsive: modal max-width 400px, centered

Update GifCreator to use className matching these styles.
Ensure all styles are self-contained within the component's Shadow DOM context.
  </action>
  <verify>Modal visually matches YouTube's dark theme, inputs are readable, buttons have hover states</verify>
  <done>Modal styled with YouTube-like dark theme, all interactive elements have proper visual feedback</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds for both Chrome and Firefox
- [ ] GIF button click opens modal overlay
- [ ] Time inputs show current video position and allow editing
- [ ] FPS and width selectors work
- [ ] Create GIF button logs settings object to console
- [ ] Cancel button closes modal
- [ ] Modal styling matches YouTube dark theme
</verification>

<success_criteria>

- All tasks completed
- All verification checks pass
- No TypeScript errors
- Modal opens/closes properly
- Time range controls functional
- Settings passed to onCreateGif callback
</success_criteria>

<output>
After completion, create `.planning/phases/03-gif-creation/03-01-SUMMARY.md`
</output>
